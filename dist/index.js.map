{"version":3,"file":"index.js","sources":["../package/src/index.js"],"sourcesContent":["import md5 from \"md5\";\n\nfunction onMissingTranslation(I18n, md5, message) {\n  return `translation missing: ${I18n.locale}.${message}`;\n}\n\nconst interpolate = (message, data, links, render) => {\n  const interpolated = message.replace(/%{([^{}]*)}/g, (_, b) => data[b]);\n\n  if (typeof render === \"function\") {\n    const parts = interpolated.match(/<<.*?>>|.+?(?=<<.*?>>|$)/g) || [];\n\n    let linkIndex = 0;\n\n    return parts.map((part, index) => {\n      if (part.startsWith(\"<<\") && part.endsWith(\">>\")) {\n        const href = links[linkIndex];\n        if (typeof href === \"undefined\") {\n          throw new Error(\"More links in template string than hrefs\");\n        }\n\n        linkIndex++;\n        return render({ text: part.slice(2, -2), href, index });\n      }\n\n      return render({ text: part, index });\n    });\n  }\n\n  return links.reduce(\n    (result, href) => result.replace(/<<(.*?)>>/, `<a href=\"${href}\">$1</a>`),\n    interpolated\n  );\n};\n\nexport default function configure(I18n) {\n  I18n.screw = function screw(message, data, { links = [], render } = {}) {\n    const hash = md5(message);\n    let translation = I18n.translations[I18n.locale]?.[hash];\n    if (typeof translation === \"undefined\") {\n      translation = onMissingTranslation(I18n, hash, message);\n    }\n    return interpolate(translation, data, links, render);\n  };\n}\n"],"names":["I18n","screw","message","data","links","render","hash","md5","translation","translations","locale","_I18n$translations$I","onMissingTranslation","interpolated","replace","_","b","parts","match","linkIndex","map","part","index","startsWith","endsWith","href","Error","text","slice","reduce","result","interpolate"],"mappings":"kGAmCkCA,GAChCA,EAAKC,MAAQ,SAAeC,EAASC,wBAA+B,SAAvBC,MAAAA,aAAQ,KAAIC,IAAAA,OACjDC,EAAOC,EAAIL,GACbM,YAAcR,EAAKS,aAAaT,EAAKU,4BAAvBC,EAAiCL,GAInD,YAH2B,IAAhBE,IACTA,EAtCN,SAA8BR,EAAMO,EAAKL,GACvC,8BAA+BF,EAAKU,WAAUR,EAqC5BU,CAAqBZ,EAAMM,EAAMJ,IAlCjC,SAACA,EAASC,EAAMC,EAAOC,GACzC,IAAMQ,EAAeX,EAAQY,QAAQ,eAAgB,SAACC,EAAGC,UAAMb,EAAKa,KAEpE,GAAsB,mBAAXX,EAAuB,CAChC,IAAMY,EAAQJ,EAAaK,MAAM,8BAAgC,GAE7DC,EAAY,EAEhB,OAAOF,EAAMG,IAAI,SAACC,EAAMC,GACtB,GAAID,EAAKE,WAAW,OAASF,EAAKG,SAAS,MAAO,CAChD,IAAMC,EAAOrB,EAAMe,GACnB,QAAoB,IAATM,EACT,UAAUC,MAAM,4CAIlB,OADAP,IACOd,EAAO,CAAEsB,KAAMN,EAAKO,MAAM,GAAI,GAAIH,KAAAA,EAAMH,MAAAA,IAGjD,OAAOjB,EAAO,CAAEsB,KAAMN,EAAMC,MAAAA,MAIhC,OAAOlB,EAAMyB,OACX,SAACC,EAAQL,UAASK,EAAOhB,QAAQ,wBAAyBW,eAC1DZ,GAWOkB,CAAYvB,EAAaL,EAAMC,EAAOC"}