{"version":3,"file":"index.umd.js","sources":["../package/src/index.js"],"sourcesContent":["import md5 from \"md5\";\n\nfunction onMissingTranslation(I18n, md5, message) {\n  return `translation missing: ${I18n.locale}.${message}`;\n}\n\nconst interpolate = (message, data, links, render) => {\n  const interpolated = message.replace(/%{([^{}]*)}/g, (_, b) => data[b]);\n\n  if (typeof render !== \"function\") {\n    return links.reduce(\n      (result, href) => result.replace(/<<(.*?)>>/, `<a href=\"${href}\">$1</a>`),\n      interpolated\n    );\n  }\n\n  const parts = interpolated.match(/<<.*?>>|.+?(?=<<.*?>>|$)/g) || [];\n\n  let linkIndex = 0;\n\n  return parts.map((part, index) => {\n    if (part.startsWith(\"<<\") && part.endsWith(\">>\")) {\n      const href = links[linkIndex];\n      if (typeof href === \"undefined\") {\n        throw new Error(\"More links in template string than hrefs\");\n      }\n\n      linkIndex++;\n      return render({ text: part.slice(2, -2), href, index });\n    }\n\n    return render({ text: part, index });\n  });\n};\n\nexport default function configure(I18n) {\n  I18n.screw = function screw(message, data, { links = [], render } = {}) {\n    const hash = md5(message);\n    let translation = I18n.translations[I18n.locale]?.[hash];\n    if (typeof translation === \"undefined\") {\n      translation = onMissingTranslation(I18n, hash, message);\n    }\n    return interpolate(translation, data, links, render);\n  };\n}\n"],"names":["I18n","screw","message","data","links","render","hash","md5","translation","translations","locale","_I18n$translations$I","onMissingTranslation","interpolated","replace","_","b","reduce","result","href","parts","match","linkIndex","map","part","index","startsWith","endsWith","Error","text","slice","interpolate"],"mappings":"uSAmCkCA,GAChCA,EAAKC,MAAQ,SAAeC,EAASC,wBAA+B,SAAvBC,MAAAA,aAAQ,KAAIC,IAAAA,OACjDC,EAAOC,EAAIL,GACbM,YAAcR,EAAKS,aAAaT,EAAKU,4BAAvBC,EAAiCL,GAInD,YAH2B,IAAhBE,IACTA,EAtCN,SAA8BR,EAAMO,EAAKL,GACvC,8BAA+BF,EAAKU,WAAUR,EAqC5BU,CAAqBZ,EAAMM,EAAMJ,IAlCjC,SAACA,EAASC,EAAMC,EAAOC,GACzC,IAAMQ,EAAeX,EAAQY,QAAQ,eAAgB,SAACC,EAAGC,UAAMb,EAAKa,KAEpE,GAAsB,mBAAXX,EACT,OAAOD,EAAMa,OACX,SAACC,EAAQC,UAASD,EAAOJ,QAAQ,wBAAyBK,eAC1DN,GAIJ,IAAMO,EAAQP,EAAaQ,MAAM,8BAAgC,GAE7DC,EAAY,EAEhB,OAAOF,EAAMG,IAAI,SAACC,EAAMC,GACtB,GAAID,EAAKE,WAAW,OAASF,EAAKG,SAAS,MAAO,CAChD,IAAMR,EAAOf,EAAMkB,GACnB,QAAoB,IAATH,EACT,UAAUS,MAAM,4CAIlB,OADAN,IACOjB,EAAO,CAAEwB,KAAML,EAAKM,MAAM,GAAI,GAAIX,KAAAA,EAAMM,MAAAA,IAGjD,OAAOpB,EAAO,CAAEwB,KAAML,EAAMC,MAAAA,MAWrBM,CAAYvB,EAAaL,EAAMC,EAAOC"}